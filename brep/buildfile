# file      : brep/buildfile
# copyright : Copyright (c) 2014-2017 Code Synthesis Ltd
# license   : MIT; see accompanying LICENSE file

define sql: file
sql{*}: extension = sql
sql{*}: install = data/

import int_libs  = libodb%lib{odb}
import int_libs += libodb-pgsql%lib{odb-pgsql}
import int_libs += libbutl%lib{butl}
import int_libs += libbpkg%lib{bpkg}

lib{brep}:                          \
{hxx         cxx}{ package        } \
{file           }{ package.xml    } \
{hxx ixx     cxx}{ package-odb    } \
{hxx            }{ package-extra  } \
{hxx         cxx}{ package-traits } \
{hxx         cxx}{ database-lock  } \
{hxx            }{ types          } \
{hxx            }{ utility        } \
{hxx            }{ version        } \
{hxx            }{ wrapper-traits } \
                   $int_libs        \
sql{package package-extra}

# For pre-releases use the complete version to make sure they cannot be used
# in place of another pre-release or the final version.
#
if $abi_prerelease
  lib{brep}: bin.lib.version = @-$version
else
  lib{brep}: bin.lib.version = @-$abi_major.$abi_minor

lib{brep}: cxx.export.poptions = "-I$out_root" "-I$src_root"
lib{brep}: cxx.export.libs = $int_libs

# Install into the brep/ subdirectory of, say, /usr/include/.
#
install.include = $install.include/brep/
